<!DOCTYPE html>
<html lang="zh-CN">
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0">
    <meta name="Keywords" content="">
    <meta name="description" content="">
    <title>RJTX Documentation</title>
    <link rel="shortcut icon" href="../../img/logo.ico" type="image/x-icon"/>
     <link rel="stylesheet" href="../../fonts/font-awesome.css"/>
      <!--字体图标 iconfont icon-*-->
      <link rel="stylesheet" href="../../fonts/iconfont.css"/>
      <!--bootstrap-->
      <link rel="stylesheet" href="../../js/bootstrap/bootstrap.css"/>
      <!--bootstrap过滤样式-->
      <link rel="stylesheet" href="../../js/bootstrap/bootstrapfiller.css"/>
      <!--checkbox/radio修饰-->
      <link rel="stylesheet" href="../../js/icheck/skins/all.css"/>
      <!--loading加载动画-->
      <link rel="stylesheet" href="../../js/loading/loading.css"/>
      <!--sweetalert弹框提示-->
      <link rel="stylesheet" href="../../js/sweetalert/sweetalert.css"/>
      <!--通用动画样式-->
      <link rel="stylesheet" href="../../css/animate.css"/>
      <!--时间插件-->
    <link rel="stylesheet" href="../../js/bootstrapDatetimepicker/bootstrap-datetimepicker.css" />
      <!--bootstrap表格-->
    <link rel="stylesheet" href="../../js/bootstrapTable/bootstrap-table.css" />
      <!--ztree树插件-->
      <link rel="stylesheet" href="../../js/ztree/css/awesomeStyle/awesome.css" type="text/css">
    <link rel="stylesheet" href="../../js/ztree/css/zTreeStyle/zTreeStyle.css" />
      <!--颜色插件-->
    <link rel="stylesheet" href="../../js/colorpicker/css/jquery-ui.css" />
    <link rel="stylesheet" href="../../js/colorpicker/css/evol-colorpicker.css" />
        <!--文件上传插件-->
    <link href="../../js/fileinput/css/fileinput.css" rel="stylesheet" type="text/css" />
    <link href="../../js/fileinput/themes/explorer-fa/theme.css" rel="stylesheet">
      <!--基础样式文件-->
    <link rel="stylesheet" href="../../css/common.css"/>
    <style>
      ul {
        list-style:inherit;
      }
    </style>
  </head>
  <body class="bg-gray p-m">
    <div class="panel-body">
      <div id="toolbar" class="btn-group">
        <button type="button" class="btn btn-default js_addOrUpdate">
          <i class="iconfont icon-add"></i> 新增
        </button>
      </div>
      <table id="table"></table>
    </div>
    <!--jQuery-->
    <script type="text/javascript" src="../../js/jquery.js" ></script>
    <script type="text/javascript" src="../../js/jquery.slimscroll.min.js" ></script>
    <!--颜色插件  jquery-ui 与boostartp样式有冲突，注意引入顺序-->
    <script type="text/javascript" src="../../js/colorpicker/js/jquery-ui.min.js" ></script>
    <script type="text/javascript" src="../../js/colorpicker/js/evol-colorpicker.js" ></script>
    <!--bootstrap-->
    <script type="text/javascript" src="../../js/bootstrap/bootstrap.js" ></script>
    <!--echart图表插件-->
    <script type="text/javascript" src="../../js/echart/echarts.js"></script>
    <script type="text/javascript" src="../../js/echart/guangdong.js"></script>
    <!--bootstrap 文件上传-->
    <script type="text/javascript" src="../../js/bootstrap/bootstrap-prettyfile.js" ></script>
    <!--checkbox/radio修饰-->
    <script type="text/javascript" src="../../js/icheck/icheck.js" ></script>
    <!--loading加载-->
    <script type="text/javascript" src="../../js/loading/loading.js" ></script>
    <!--sweetalert提示框-->
    <script type="text/javascript" src="../../js/sweetalert/sweetalert-dev.js" ></script>
    <!--tip 错误操作提示框-->
    <script type="text/javascript" src="../../js/tip.js" ></script>
    <!--时间插件-->
    <script type="text/javascript" src="../../js/bootstrapDatetimepicker/moment-with-locales.js" ></script>
    <script type="text/javascript" src="../../js/bootstrapDatetimepicker/bootstrap-datetimepicker.min.js" ></script>
    <!--bootstrap表格-->
    <script type="text/javascript" src="../../js/bootstrapTable/bootstrap-table.js" ></script>
    <script type="text/javascript" src="../../js/bootstrapTable/locale/bootstrap-table-zh-CN.js" ></script>
    <!--验证插件-->
    <script type="text/javascript" src="../../js/jQueryValidation/jquery.validate.js" ></script>
    <script type="text/javascript" src="../../js/jQueryValidation/jquery.validate.messages_zh.js"></script>
    <!--ztree树插件-->
    <script type="text/javascript" src="../../js/ztree/js/jquery.ztree.core.js" ></script>
    <script type="text/javascript" src="../../js/ztree/js/jquery.ztree.exedit.js" ></script>
    <script type="text/javascript" src="../../js/ztree/js/jquery.ztree.excheck.js" ></script>
    <script type="text/javascript" src="../../js/ztree/js/jquery.ztree.exhide.js" ></script>
    <script type="text/javascript" src="../../js/ztree/js/ztree.search.js" ></script>
    <!--富文本编辑器-->
    <script type="text/javascript" src="../../js/wangEditor/wangEditor.min.js" ></script>
    <!--代码渲染-->
    <script type="text/javascript" src="../../js/codeMirro/js/codemirror.js" ></script>
    <script src="../../js/codeMirro/addon/search/searchcursor.js"></script>
    <script src="../../js/codeMirro/addon/search/searchcursor.js"></script>
    <script src="../../js/codeMirro/addon/dialog/dialog.js"></script>
    <script src="../../js/codeMirro/addon/edit/matchbrackets.js"></script>
    <script src="../../js/codeMirro/addon/edit/closebrackets.js"></script>
    <script src="../../js/codeMirro/addon/comment/comment.js"></script>
    <script src="../../js/codeMirro/addon/wrap/hardwrap.js"></script>
    <script src="../../js/codeMirro/addon/fold/foldcode.js"></script>
    <script src="../../js/codeMirro/addon/fold/brace-fold.js"></script>
    <script src="../../js/codeMirro/keymap/sublime.js"></script>
    <!--文件上传插件-->
    <script src="../../js/fileinput/js/fileinput.js"></script>
    <script src="../../js/fileinput/themes/explorer-fa/theme.js"></script>
    <script src="../../js/fileinput/js/locales/zh.js"></script>
    <!--工具js-->
    <script type="text/javascript" src="../../js/util.js"></script>
    <!--业务通用js-->
    <script type="text/javascript" src="../../js/rjtx.js" ></script>
  <script>
    let docList = {
      init(){
        this.list();
        this.add();
      },
      add(){
        $(".js_addOrUpdate").click(function(){
          let editor1,editor2;
          rj.modal({
            title:"新增事例界面",
            url:"./page/addOrUpdate.html",
            size:"modal-lg",
            loadback(){
               var E = window.wangEditor
                editor1 = new E('.js_editor1')
                editor1.create()
                editor2 = new E('.js_editor2')
                editor2.create()
                rj.resetPlug();
                
                $(".file").fileinput({
                  uploadUrl:"/addOrUpdate",
                  uploadExtraData:function (previewId, index) {
                    let formJSON = rj.form.get($("#addOrUpdate")[0]);
                    formJSON.discription = editor1.txt.html();
                    formJSON.args = editor2.txt.html();
                      var obj = {};
                      $('.your-form-class').find('input').each(function() {
                          var id = $(this).attr('id'), val = $(this).val();
                          obj[id] = val;
                      });
                      console.log(obj)
                      return formJSON;
                  },
                  
                });
                
                
                
                /**
                 * 
                 * initialPreview: [
            '<img class="file-preview-image kv-preview-data" src="http://lorempixel.com/800/460/city/1">',
            '<img class="file-preview-image kv-preview-data" src="http://lorempixel.com/800/460/city/2">',
        ],
        initialPreviewConfig: [
            {caption: "City-1.jpg", size: 327892, url: "/site/file-delete", key: 1},
            {caption: "City-2.jpg", size: 438828, url: "/site/file-delete", key: 2}, 
        ],
                 *
                 */
                
            },
            sureback(){
               $("#addOrUpdate").validate({
                rules: {
                    key: {
                        required: true,
                        remote:"/checkKey",
                    }
                   
                },
                messages: {
                     key: {
                        remote:v_icon+"key已经存在"
                    }
                },
                submitHandler: function () {
                  console.log("运行")
                  $(".file").fileinput("upload");
                  
                 /* rj.ajax("/addOrUpdate",{data:formJSON}).then((e)=>{
                    console.log(e)
                  });*/
                 }
                })
            }
          });
          
        });
      },
      list(){
        rj.table.init({
          id:"#table",
          toolbar:"#toolbar",
          url:'/list',
          uniqueId:"id",
          sidePagination:"client",
          queryParams:function(params) {
            //将查询格式化,得到查询参数,传到后台
                  /*return{
                    //每页条数cv
                    pageSize:params.limit,
                    //页码
                    pageNum:(params.offset+params.limit)/params.limit,
                    //这里是读取sortName配置选项,排序名称
                    sortName:params.sort,
                    //排序规定,按时间顺序
                    sortOrder:params.order,//默认是desc
                  }*/
               },
          columns: [{
              field: 'key',
              title: 'key'
            }, {
              field: 'discription',
              title: '描述'
            }, {
              field: 'args',
              title: '参数'
            }, {
              field: 'res',
              title: '事例路径'
            }, {
              title: '操作',
              width: "110",
              formatter:function(value,row,index){
                  return "<a href='javascript:;' id='"+value+"' onclick='userManage.update(this.id)' class='btn btn-info btn-xs m-r-xs'>修改</a>"+
                  "<a href='javascript:;' id='"+value+"' onclick='userManage.delOne(this.id)' class='btn btn-danger btn-xs'>删除</a>";
              }
            }],
        });
      }
    }
    docList.init();
  </script>
  </body>
</html>
