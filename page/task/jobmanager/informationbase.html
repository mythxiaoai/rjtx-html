<div class="p-m js_info_content">
    <div class="panel panel-white">
        <div class="panel-heading"><div class="panel-title">任务信息库</div></div>
        <div class="panel-body collapsed in ">
            <div class="col-md-12">
                <form class="form-inline fz12 clearfix">
                    <div class="form-group">
                        <label class="fw-n">项目
                            <select class="form-control" name="project">
                                <option value="">--请选择--</option>
                                <option value="1">广州项目</option>
                                <option value="2">深圳项目</option>
                            </select>
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="fw-n">任务名称
                            <input type="text" class="form-control" name="taskname"/>
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="fw-n">任务类型
                            <select class="form-control" name="type">
                                <option value="">--请选择--</option>
                                <option value="1">状态库低端</option>
                                <option value="2">方案库中端</option>
                            </select>
                        </label>
                    </div>
                    <div class="form-group">
                        <input class="btn btn-default btn-sm js_tasksearch m-r-sm" type="button" value="查询">
                        <input class="btn btn-default btn-sm" onclick="reset()" type="button" value="重置">
                    </div>
                </form>
                <div class="row m-t">
                    <div class="col-md-12">
                        <ul class="nav nav-tabs"> 
                            <li class="active"><a href="#tasktab1" data-toggle="tab">新增</a></li>
                            <li><a href="#tasktab2" data-toggle="tab">审核</a></li>
                            <li><a href="#tasktab3" data-toggle="tab">执行</a></li>
                            <li><a href="#tasktab4" data-toggle="tab">评审</a></li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane fade in active" id="tasktab1">
                                <button onclick="information.addOrUpdate('id','table0')" type="button" class="btn btn-default  m-t btn-md"><i class="iconfont icon-add"></i> 新增</button>
                                <div class="form-group m-b-xs  m-t pull-right">
                                    <button type="button" class="btn btn-default m-r ">任务模板下载
                                        <i class="iconfont icon-xiazai"></i> 
                                    </button>
                                    <button type="button" class="btn btn-default js_taskImport">上传任务
                                        <i class="iconfont icon-shangchuan "></i> 
                                    </button>
                                </div>
                                <table id="table1"></table>
                            </div>
                            <div class="tab-pane fade" id="tasktab2">
                                <button type="button" class="btn btn-default  m-t btn-md " >批量审核</button>
                                <table id="table2"></table>
                            </div>
                            <div class="tab-pane fade" id="tasktab3">
                                <button type="button" class="btn btn-default  m-t btn-md">批量执行</button>
                                <table id="table3"></table>
                            </div>
                            <!-- onclick="information.batchOpration('#tasktab4')" -->
                            <div class="tab-pane fade" id="tasktab4">
                                <button type="button" class="btn btn-default  m-t btn-md js_del" >批量评审</button>
                                <table id="table4"></table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
<script>
    var information = {
        init(){
            this.tab1_table();
            this.tab2_table();
            this.tab3_table();
            this.tab4_table();
            this.taskUpdate();
            this.batchOpration();
        },
        batchOpration(){
            $(".js_del").click(function(){
                var rowData = $("#table4").bootstrapTable('getAllSelections');
                if(rowData.length==0){
                    xtip("selectLeastOne")
                }else{
                    rj.modal("提交评审","page/task/jobmanager/addregral.html",
                        ()=>{
                            $("#addDregral").validate({
                                rules: {
                                    score:{
                                        required: true
                                    }
                                },
                                submitHandler: function() {
                                    xalert('操作成功','数据已经操作成功！','success');
                                }
                            })
                        }
                    )
                }
            });
           
        },
        addOrUpdate(id,tab){
            //新增表单页面/查看
            rj.load(".js_info_content","page/task/jobmanager/addOrUpdate.html",function(){
                console.log(tab);
                if(tab == "table0"){
                    $("#testtitle").html('新增任务')

                }else if(tab == "table1"){
                    $("#testtitle").html('修改任务')
                    
                }else if(tab == "table2"){
                    $("#testtitle").html('任务详情')
                    
                }else if(tab == "table3"){
                    $("#testtitle").html('任务详情')
                    
                }else{
                    // 审核页面
                    $("#testtitle").html('任务详情')
                    
                }
            });
        },
        taskUpdate(){
            //上传任务
            $(".js_taskImport").click(()=>{
                rj.modal("上传任务","./page/task/jobmanager/importTask.html",
                    ()=>{
                        rj.resetPlug();
                    },
                    $("#imporTask").validate({
                        rules: {
				            input1: {
				                required: true
				            },
				            file: {
				                required: true
				            },
				        },
				        messages: {
				             file: {
				                required:v_icon+"请选择上传的文件~"
				            }
				        },
                        submitHandler: function (){
                            //获取form表单的数据
                        }
                    })
                )
            })
        },
        tab1_table(){
            rj.table.init({
                id:"#table1",
                pagination: true, //分页
                sidePagination: "client", //服务端处理分页
                pageNumber:1, // 默认显示第几页
                pageSize: 10, // 每页显示条数  
                data: [
                    {
                       "id":0,
                       "name": "每日指标通报",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 1
                    },
                    {
                       "id":1,
                       "name": "阿打算打算打算多",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 1
                    },
                    {
                       "id":2,
                       "name": "每日指标通报",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 1
                    },
                    {
                       "id":3,
                       "name": "每日指标通报",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 1
                    },
                    {
                       "id":4,
                       "name": "每日指标通报",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 1
                    },
                    {
                       "id":5,
                       "name": "每日指标通报",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 1
                    }
                    
                ],
                columns: [
                    {
                        checkbox: true 
                    },
                    {
						field: 'id',
                        title: 'id',
                        sortable:true
                    },
                    {
						field: 'name',
						title: '任务名称',
                        sortable:true
                    },
                    {
						field: 'attribute',
						title: '任务属性',
                        sortable:true
                    },
                    {
						field: 'type',
						title: '任务类型',
                        sortable:true
                    },
                    {
						field: 'limittime',
						title: '处理时限',
                        sortable:true
                    },
                    {
						field: 'createtime',
						title: '创建时间',
                        sortable:true
                    },
                    {
						field: 'integral',
						title: '积分任务',
                        sortable:true
                    },
                    {
						field: 'auditresu',
						title: '审核结果',
                        sortable:true,
                        formatter: function(value,row,index) {
                            if(value == 0){
                                return `<span class="text-success">通过</span>`
                            }else{
                                return `<span class="text-danger">不通过</span>`
                            }
                        }
					},
                    {
                        title: '操作',
                        formatter: function(value, row, index) {
                            return `
		                    <div style="width:100px">
                                <a class="btn btn-info btn-xs" data-auth="/project/assessment/getAssessmentInfo" onclick="information.addOrUpdate('${row.id}','table1',)">修改</a>
		              		<div/>`
                        }
                    }
                ]
            });
        },
        tab2_table(){
            rj.table.init({
                id:"#table2",
                pagination: true, //分页
                sidePagination: "client", //服务端处理分页
                pageNumber:1, // 默认显示第几页
                pageSize: 10, // 每页显示条数  
                data: [
                    {
                       "id":0,
                       "name": "1",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 1
                    }
                    
                ],
                columns: [
                    {
						checkbox: true 
					},
                    {
						field: 'id',
                        title: 'id',
                        sortable:true
                    },
                    {
						field: 'name',
						title: '任务名称',
                        sortable:true
                    },
                    {
						field: 'attribute',
						title: '任务属性',
                        sortable:true
                    },
                    {
						field: 'type',
						title: '任务类型',
                        sortable:true
                    },
                    {
						field: 'limittime',
						title: '处理时限',
                        sortable:true
                    },
                    {
						field: 'createtime',
						title: '创建时间',
                        sortable:true
                    },
                    {
						field: 'integral',
						title: '积分任务',
                        sortable:true
                    },
                    {
                        title: '操作',
                        formatter: function(value, row, index) {
                            return `
		                    <div style="width:100px">
                                <a class="btn btn-info btn-xs" data-auth="/project/assessment/getAssessmentInfo" onclick="information.addOrUpdate('${row.id}','table2',)"">查看详情</a>
		              		<div/>`
                        }
                    }
                ]
            });
        },
        tab3_table(){
            rj.table.init({
                id:"#table3",
                pagination: true, //分页
                sidePagination: "client", //服务端处理分页
                pageNumber:1, // 默认显示第几页
                pageSize: 10, // 每页显示条数  
                data: [
                    {
                       "id":0,
                       "name": "rwerwer",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 1
                    },
                    {
                       "id":1,
                       "name": "阿打算打算打算多",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 0
                    },
                    {
                       "id":2,
                       "name": "每日指标通报",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 0
                    }
                    
                ],
                columns: [
                    {
                        checkbox: true 
                    },
                    {
						field: 'id',
                        title: 'id',
                        sortable:true
                    },
                    {
						field: 'name',
						title: '任务名称',
                        sortable:true
                    },
                    {
						field: 'attribute',
						title: '任务属性',
                        sortable:true
                    },
                    {
						field: 'type',
						title: '任务类型',
                        sortable:true
                    },
                    {
						field: 'limittime',
						title: '处理时限',
                        sortable:true
                    },
                    {
						field: 'createtime',
						title: '创建时间',
                        sortable:true
                    },
                    {
						field: 'integral',
						title: '积分任务',
                        sortable:true
                    },
                    {
                        title: '操作',
                        formatter: function(value, row, index) {
                            return `
		                    <div style="width:100px">
                                <a class="btn btn-info btn-xs" data-auth="/project/assessment/getAssessmentInfo" onclick="information.addOrUpdate('${row.id}','table3',)">查看详情</a>
		              		<div/>`
                        }
                    }
                ]
            });
        },
        tab4_table(){
            rj.table.init({
                id:"#table4",
                pagination: true, //分页
                sidePagination: "client", //服务端处理分页
                pageNumber:1, // 默认显示第几页
                pageSize: 10, // 每页显示条数  
                data: [
                    {
                       "id":0,
                       "name": "test2",
                       "attribute":  "实时任务",
                       "type": "日常任务",
                       "limittime": "2019-01-11 18:00:00",
                       "createtime": "2019-11-11 12:10:30",
                       "integral": 10,
                       "auditresu": 1
                    }
                    
                ],
                columns: [
                    {
                        checkbox: true 
                    },
                    {
						field: 'id',
                        title: 'id',
                        sortable:true
                    },
                    {
						field: 'name',
						title: '任务名称',
                        sortable:true
                    },
                    {
						field: 'attribute',
						title: '任务属性',
                        sortable:true
                    },
                    {
						field: 'type',
						title: '任务类型',
                        sortable:true
                    },
                    {
						field: 'limittime',
						title: '处理时限',
                        sortable:true
                    },
                    {
						field: 'createtime',
						title: '创建时间',
                        sortable:true
                    },
                    {
						field: 'integral',
						title: '积分任务',
                        sortable:true
                    },
                    {
                        title: '操作',
                        formatter: function(value, row, index) {
                            return `
		                    <div style="width:100px">
                                <a class="btn btn-info btn-xs" data-auth="/project/assessment/getAssessmentInfo"  onclick="information.addOrUpdate('${row.id}','table4',)"">查看详情</a>
		              		<div/>`
                        }
                    }
                ]
            });
        }
    };
    information.init();
</script>
<style>

</style>